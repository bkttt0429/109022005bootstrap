# ERP 訂單管理核心演算法

在 ERP 系統中，訂單管理不再只是單純的資料輸入，其核心價值在於透過**演算法（Algorithms）**在複雜的變數（如有限的庫存、變動的交期、多個倉庫）中找出最佳解。

以下是 ERP 訂單管理中最核心的幾類演算法與邏輯：

---

### 1. 庫存分配演算法 (Inventory Allocation)

當多個訂單競爭有限的庫存時，系統會依據預設邏輯自動分配：

* **FIFO (先進先出)：** 根據訂單建立的時間戳記，最先下單的優先配貨。
* **優先級權重 (Priority Scoring)：** 根據客戶等級（如 VIP）、訂單金額或緊急程度計算評分。
* **等比例分配 (Pro-rata)：** 當庫存極度短缺時，按訂單需求比例分配。例如庫存僅 50 個，訂單 A 要 100 個，訂單 B 要 100 個，則各分 25 個。

### 2. ATP 與 CTP：交期承諾演算法

這是 ERP 判斷「何時能交貨」的核心邏輯：

* **ATP (Available-to-Promise，可承諾量)：** 計算公式：$ATP = Current Inventory + Planned Supply - Committed Orders$。
系統會掃描未來時間軸上的庫存增減，給出確切的配貨日期。
* **CTP (Capable-to-Promise，可生產承諾)：** 當庫存不足時，演算法會深入產線，計算物料清單（BOM）與產能（Capacity），判斷若現在投產，最快何時能完工出貨。

---

### 3. 分散式訂單管理路由 (DOM Routing)

對於擁有多個倉庫或門市的企業，演算法決定由「哪裡」出貨：

* **最近鄰居演算法 (Nearest Neighbor)：** 計算收貨地址與各倉庫間的地理距離，選擇路徑最短者。
* **物流成本最優化：** 考量不同運送方式（快遞、貨運）的費率，找出總成本最低的出貨點。
* **庫存平衡邏輯 (Inventory Balancing)：** 優先從「庫存積壓過多」或「即期品」較多的倉庫出貨，以優化全渠道的周轉率。

### 4. 自動化補貨與 EOQ 模型

為了確保訂單不會因為缺貨而中斷，系統會結合**經濟訂購量（EOQ）**模型：

> $EOQ = \sqrt{\frac{2DS}{H}}$
> 其中：
> * $D$: 年需求量
> * $S$: 每次訂購成本
> * $H$: 單位庫存持有成本

演算法會自動計算**再訂購點 (Reorder Point, ROP)**：
$ROP = (Average Daily Usage \times Lead Time) + Safety Stock$

---

### 5. 訂單履行優化 (Order Picking Optimization)

在倉庫端，演算法會優化揀貨路徑：

* **波次規劃 (Wave Planning)：** 將性質相似的訂單（如相同貨區、相同配送路線）彙整成一個「波次」，減少揀貨人員在倉庫來回走動的時間。
* **路徑演算法 (Pathfinding Algorithms)：** 利用類似於 A* 或 Dijkstra 的算法，規劃揀貨車在貨架間的最短行進路徑。

---

### 總結：演算法帶來的量化效益

透過這些演算法，企業可以達到以下目標：

| 演算法類型 | 解決問題 | 核心目標 |
| --- | --- | --- |
| **分配演算法** | 誰先拿貨？ | 公平性與利潤最大化 |
| **ATP / CTP** | 什麼時候拿貨？ | 交期準確度 |
| **DOM 路由** | 從哪裡發貨？ | 物流成本與速度優化 |
| **EOQ / ROP** | 什麼時候買貨？ | 庫存持有成本最小化 |
