{
    "name": "ERP+ Auto-Ship (V16 Classic Expression)",
    "nodes": [
        {
            "parameters": {
                "httpMethod": "POST",
                "path": "order-status-changed",
                "options": {}
            },
            "type": "n8n-nodes-base.webhook",
            "typeVersion": 1,
            "position": [
                250,
                300
            ],
            "id": "webhook-trigger",
            "name": "Webhook: Order Status Changed",
            "webhookId": "order-status-webhook"
        },
        {
            "parameters": {
                "rule": {
                    "interval": [
                        {
                            "field": "minutes",
                            "minutesInterval": 5
                        }
                    ]
                }
            },
            "type": "n8n-nodes-base.scheduleTrigger",
            "typeVersion": 1.1,
            "position": [
                250,
                500
            ],
            "id": "cron-trigger",
            "name": "Schedule: Every 5 Minutes"
        },
        {
            "parameters": {
                "conditions": {
                    "string": [
                        {
                            "value1": "={{$json.body.data.status}}",
                            "operation": "equal",
                            "value2": "Paid"
                        }
                    ]
                }
            },
            "type": "n8n-nodes-base.if",
            "typeVersion": 1,
            "position": [
                450,
                300
            ],
            "id": "check-paid-webhook",
            "name": "Is Paid? (Webhook)"
        },
        {
            "parameters": {
                "requestMethod": "GET",
                "url": "={{ 'http://10.28.14.243/109022005bootstrap/main_app/api/orders_api.php?api_key=erp_n8n_secret_88d4f20&action=update_status&status=Shipped&id=' + $json.body.entity_id }}",
                "options": {},
                "headerParametersUi": {
                    "parameter": [
                        {
                            "name": "X-ERP-API-KEY",
                            "value": "erp_n8n_secret_88d4f20"
                        }
                    ]
                },
                "jsonParameters": true,
                "bodyParametersUi": {
                    "parameter": [
                        {
                            "name": "action",
                            "value": "update_status"
                        },
                        {
                            "name": "id",
                            "value": "={{$json.body.entity_id}}"
                        },
                        {
                            "name": "status",
                            "value": "Shipped"
                        }
                    ]
                }
            },
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 3,
            "position": [
                650,
                200
            ],
            "id": "ship-webhook-order",
            "name": "Ship Order (Webhook)"
        },
        {
            "parameters": {
                "requestMethod": "GET",
                "url": "http://10.28.14.243/109022005bootstrap/main_app/api/orders_api.php?api_key=erp_n8n_secret_88d4f20",
                "options": {},
                "headerParametersUi": {
                    "parameter": [
                        {
                            "name": "X-ERP-API-KEY",
                            "value": "erp_n8n_secret_88d4f20"
                        }
                    ]
                }
            },
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 3,
            "position": [
                450,
                500
            ],
            "id": "fetch-all-orders",
            "name": "Get All Orders"
        },
        {
            "parameters": {
                "conditions": {
                    "string": [
                        {
                            "value1": "={{$json.status}}",
                            "operation": "equal",
                            "value2": "Paid"
                        }
                    ]
                }
            },
            "type": "n8n-nodes-base.filter",
            "typeVersion": 1,
            "position": [
                650,
                500
            ],
            "id": "filter-paid-orders",
            "name": "Filter Paid Orders"
        },
        {
            "parameters": {
                "requestMethod": "GET",
                "url": "={{ 'http://10.28.14.243/109022005bootstrap/main_app/api/orders_api.php?api_key=erp_n8n_secret_88d4f20&action=update_status&status=Shipped&id=' + $json.id }}",
                "options": {},
                "headerParametersUi": {
                    "parameter": [
                        {
                            "name": "X-ERP-API-KEY",
                            "value": "erp_n8n_secret_88d4f20"
                        }
                    ]
                },
                "jsonParameters": true,
                "bodyParametersUi": {
                    "parameter": [
                        {
                            "name": "action",
                            "value": "update_status"
                        },
                        {
                            "name": "id",
                            "value": "={{$json.id}}"
                        },
                        {
                            "name": "status",
                            "value": "Shipped"
                        }
                    ]
                }
            },
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 3,
            "position": [
                850,
                500
            ],
            "id": "ship-cron-order",
            "name": "Ship Order (Cron)"
        },
        {
            "parameters": {
                "content": "## ğŸš€ V16 ç¶“å…¸è¡¨é”å¼ç‰ˆ\n\n**ä¿®æ­£é …ç›®ï¼š**\n1. **Classic Expression**: ä½¿ç”¨ `{{ 'url' + id }}` ç¶“å…¸èªæ³•ï¼Œé€™æ˜¯ n8n æœ€ç©©å®šçš„è¡¨é”å¼å¯«æ³•ã€‚\n2. **è§£æ±º Invalid URL**: é¿å…ä½¿ç”¨è¼ƒæ–°çš„ JS èªæ³•ï¼Œç¢ºä¿ URL è¢«æ­£ç¢ºè§£æèˆ‡é€å‡ºã€‚\n\n**é€™æ˜¯æœ€å¾Œçš„å¸Œæœ›ï¼**",
                "height": 280,
                "width": 350
            },
            "type": "n8n-nodes-base.stickyNote",
            "typeVersion": 1,
            "position": [
                180,
                80
            ],
            "id": "note-v11",
            "name": "V11 èªªæ˜"
        }
    ],
    "connections": {
        "Webhook: Order Status Changed": {
            "main": [
                [
                    {
                        "node": "Is Paid? (Webhook)",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Schedule: Every 5 Minutes": {
            "main": [
                [
                    {
                        "node": "Get All Orders",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Is Paid? (Webhook)": {
            "main": [
                [
                    {
                        "node": "Ship Order (Webhook)",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Get All Orders": {
            "main": [
                [
                    {
                        "node": "Filter Paid Orders",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Filter Paid Orders": {
            "main": [
                [
                    {
                        "node": "Ship Order (Cron)",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        }
    },
    "settings": {
        "executionOrder": "v1"
    }
}